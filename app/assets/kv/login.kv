<LoginScreen>:
    name: "login"

    canvas.before:
        Color:
            rgba: 0.05, 0.1, 0.2, 1  # Fond bleu marine
        Rectangle:
            pos: self.pos
            size: self.size

    MDFloatLayout:

        MDCard:
            size_hint: 0.9, 0.75
            pos_hint: {"center_x": 0.5, "center_y": 0.5}
            md_bg_color: 0.1, 0.15, 0.25, 0.95  # Effet verre foncé
            elevation: 20
            radius: [25, 25, 25, 25]
            padding: dp(25)
            orientation: "vertical"
            spacing: dp(25)

            MDBoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: self.minimum_height
                spacing: dp(10)
                pos_hint: {"center_x": 0.5}

                # Conteneur pour l'icône avec effets
                FloatLayout:
                    size_hint: None, None
                    size: dp(80), dp(80)
                    pos_hint: {"center_x": 0.48, "center_y": 0.48}
                    
                    canvas.before:
                        # Ombre portée subtile
                        Color:
                            rgba: 0, 0, 0, 0.15
                        Ellipse:
                            pos: self.x + dp(2), self.y - dp(2)
                            size: dp(60), dp(60)
                        
                        # Cercle de fond avec bordure
                        Color:
                            rgba: 0.2, 0.4, 0.8, 0.1
                        Ellipse:
                            pos: self.x + dp(3), self.y + dp(3)
                            size: dp(60), dp(60)
                        
                        # Bordure circulaire
                        Color:
                            rgba: 0.3, 0.6, 1, 0.3
                        Line:
                            circle: [self.center_x, self.center_y, dp(30)]
                            width: dp(1.5)
                    
                    Image:
                        id: drone_image
                        size_hint: None, None
                        size: dp(60), dp(60)
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        allow_stretch: True
                        keep_ratio: True
                        angle: 0
                        canvas.before:
                            # Masque circulaire pour l'image
                            StencilPush
                            Ellipse:
                                pos: self.pos
                                size: self.size
                            StencilUse
                        canvas.after:
                            StencilUnUse
                            StencilPop
                            PushMatrix
                            Rotate:
                                angle: self.angle
                                origin: self.center
                            PopMatrix

                MDLabel:
                    text: "App Missions Drone"
                    halign: "center"
                    font_style: "H5"
                    theme_text_color: "Custom"
                    text_color: 1, 1, 1, 1
                    size_hint_y: None
                    height: self.texture_size[1]

            MDTextField:
                id: username
                hint_text: "Nom d'utilisateur"
                icon_right: "account"
                mode: "rectangle"
                radius: [10, 10, 10, 10]
                size_hint_y: None
                height: dp(50)
                line_color_normal: 0.5, 0.7, 1, 1
                text_color: 1, 1, 1, 1
                icon_right_color: 1, 1, 1, 1
                hint_text_color_normal: .8, .8, .8, 1

            MDTextField:
                id: password
                hint_text: "Mot de passe"
                password: True
                icon_right: "lock"
                mode: "rectangle"
                radius: [10, 10, 10, 10]
                size_hint_y: None
                height: dp(50)
                line_color_normal: 0.5, 0.7, 1, 1
                text_color: 1, 1, 1, 1
                icon_right_color: 1, 1, 1, 1
                hint_text_color_normal: .8, .8, .8, 1

            MDRaisedButton:
                text: "Connexion"
                pos_hint: {"center_x": 0.5}
                size_hint_x: 0.7
                height: dp(45)
                md_bg_color: 0.2, 0.6, 1, 1
                text_color: 1, 1, 1, 1
                radius: [12, 12, 12, 12]
                on_release: root.do_login()

            MDTextButton:
                id: create_account_button
                text: "Créer un compte"
                pos_hint: {"center_x": 0.5}
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 1
                on_release: app.root.current = "register"
                opacity: 0
                disabled: True
